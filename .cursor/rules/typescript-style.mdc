---
globs: *.ts,*.tsx
---

# TypeScript Code Style

Follow these TypeScript conventions used throughout the project:

## Type Safety

- **Strict mode enabled**: All strict TypeScript options are on
    - `noImplicitAny`, `strictNullChecks`, `strictPropertyInitialization`
- **Explicit types**: Prefer explicit type annotations for function returns
- **Type imports**: Always use separate type imports
    ```typescript
    import type { SomeType } from './module';
    import { someFunction } from './module';
    ```
- **No `any`**: Avoid `any` types - use `unknown` if type is truly unknown

## Class & Member Conventions

- **Explicit accessibility**: Always declare `public`, `private`, or `protected` on class members
    ```typescript
    export class MyClass {
    	public publicMethod(): void {}
    	private _privateField: string = '';
    }
    ```
- **Private fields**: Prefix with underscore (`_privateField`)
- **Readonly preference**: Use `readonly` for fields that don't change (especially in lambdas)
- **No `this` reassignment**: Avoid aliasing `this` - use arrow functions

## Code Style

- **Quotes**: Single quotes for strings (except to avoid escaping)
- **Semicolons**: Not enforced by Prettier but follow existing patterns
- **Arrow functions**: Prefer arrow functions for callbacks (`prefer-arrow-callback`)
- **Curly braces**: Always use curly braces for blocks
- **Equality**: Use `===` and `!==` (avoid `==` and `!=`)
- **Const preference**: Use `const` by default, `let` only when reassignment needed

## Async/Await

- **Await thenables**: Always `await` promises (no floating promises)
- **Async functions**: Mark functions `async` if they return promises
- **Void return**: Be careful with `checksVoidReturn` - understand when promises are checked

## Imports

- **Relative imports**: Always use relative imports (e.g., `../../../server/modules/device/cluster`)
    - Do NOT use absolute imports or path aliases
    - Import paths should be relative to the current file
- **No unused imports**: Unused imports will be flagged
- **Module resolution**: Node16 module resolution
- **Import order**: Imports are auto-sorted by prettier-plugin-sort-imports

## Error Handling

- Avoid `no-async-promise-executor`
- Handle promises properly - don't leave them floating
- Log errors appropriately using the project's logging utilities
